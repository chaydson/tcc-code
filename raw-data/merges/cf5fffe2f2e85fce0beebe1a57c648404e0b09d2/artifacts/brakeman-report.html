<!DOCTYPE HTML SYSTEM>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Brakeman Report</title>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript">
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block") {
        elem.style.display = "block";

        elem.querySelectorAll("table").forEach(function(table) {
          $(table).DataTable().columns.adjust();
        });
      } else {
        elem.style.display = "none";
      }

      elem.parentNode.scrollIntoView();
    }

    $(document).ready(function() {
      $('table').DataTable({
        searching: false,
        paging:    false,
        info:      false
      });
    });
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

a {
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

 div.render_path {
   display: none;
   background-color: #ffe;
   padding: 5px;
   margin: 2px 0px 2px 0px;
 }

 div.template_name {
   cursor: pointer;
 }

 div.template_name:hover {
   background-color: white;
 }

 span.code {
   font-family: monospace;
 }

 span.filename {
   font-family: monospace;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <thead>
    <tr>
      <th>Application Path</th>
      <th>Rails Version</th>
      <th>Brakeman Version</th>
      <th>Report Time</th>
      <th>Checks Performed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>/app</td>
      <td>6.1.7.2</td>
      <td>7.1.1</td>
      <td>
        2025-11-18 17:52:06 +0000<br><br>
        4.543594262 seconds
      </td>
      <td>BasicAuth, BasicAuthTimingAttack, CSRFTokenForgeryCVE, ContentTag, CookieSerialization, CreateWith, CrossSiteScripting, DefaultRoutes, Deserialize, DetailedExceptions, DigestDoS, DynamicFinders, EOLRails, EOLRuby, EscapeFunction, Evaluation, Execute, FileAccess, FileDisclosure, FilterSkipping, ForgerySetting, HeaderDoS, I18nXSS, JRubyXML, JSONEncoding, JSONEntityEscape, JSONParsing, LinkTo, LinkToHref, MailTo, MassAssignment, MimeTypeDoS, ModelAttrAccessible, ModelAttributes, ModelSerialize, NestedAttributes, NestedAttributesBypass, NumberToCurrency, PageCachingCVE, Pathname, PermitAttributes, QuoteTableName, Ransack, Redirect, RegexDoS, Render, RenderDoS, RenderInline, ResponseSplitting, RouteDoS, SQL, SQLCVEs, SSLVerify, SafeBufferManipulation, SanitizeConfigCve, SanitizeMethods, SelectTag, SelectVulnerability, Send, SendFile, SessionManipulation, SessionSettings, SimpleFormat, SingleQuotes, SkipBeforeFilter, SprocketsPathTraversal, StripTags, SymbolDoSCVE, TemplateInjection, TranslateBug, UnsafeReflection, UnsafeReflectionMethods, ValidationRegex, VerbConfusion, WeakRSAKey, WithoutProtection, XMLDoS, YAMLParsing</td>
    </tr>
  </tbody>
</table>
<br>
<h2 id='summary'>Summary</h2>
<table>
  <thead>
    <tr>
      <th>Scanned/Reported</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Controllers</td>
      <td>47</td>
    </tr>
    <tr>
      <td>Models</td>
      <td>26</td>
    </tr>
    <tr>
      <td>Templates</td>
      <td>325</td>
    </tr>
    <tr>
      <td>Errors</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Security Warnings</td>
      <td>18 <span class='high-confidence'>(6)</span></td>
    </tr>
  
    <tr>
      <td>Ignored Warnings</td>
      <td>0</td>
    </tr>
  
  </tbody>
</table>
<br>
<table>
  <thead>
    <tr>
      <th>Warning Type</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td>Cross-Site Scripting</td>
      <td>3</td>
    </tr>
  
    <tr>
      <td>Format Validation</td>
      <td>1</td>
    </tr>
  
    <tr>
      <td>Mass Assignment</td>
      <td>4</td>
    </tr>
  
    <tr>
      <td>Missing Authorization</td>
      <td>1</td>
    </tr>
  
    <tr>
      <td>Redirect</td>
      <td>2</td>
    </tr>
  
    <tr>
      <td>Remote Code Execution</td>
      <td>1</td>
    </tr>
  
    <tr>
      <td>SQL Injection</td>
      <td>4</td>
    </tr>
  
    <tr>
      <td>Unmaintained Dependency</td>
      <td>2</td>
    </tr>
  
  </tbody>
</table>
<br>
<h2>Security Warnings</h2>  
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Class</th>
      <th>Method</th>
      <th>Warning Type</th>
      <th>CWE ID</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>Decidim::Proposals::Admin::ParticipatoryTextsController</td>
      <td>update</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
      <td>[601]</td>
      <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" >Possible unprotected redirect near line 68: <span class="code">redirect_to(<span class="user_input">params.require(:preview_participatory_text).permit![:preview_url]</span>)</span><table id='context8' class='context' style='display:none'><caption>app/controllers/decidim/proposals/admin/participatory_texts_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>63</pre>
          </td>
          <td class='context'>
            <pre class='context'>          @preview_form = form(Admin::PreviewParticipatoryTextForm).from_params(proposals: form_params[:proposals_attributes]&amp;.values, proposal_to_add: form_params[:proposal_to_add])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>          if params[:save_draft].present? || params[:show_preview].present? || params[:is_from_participatory_text_preview].present?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>            UpdateParticipatoryText.call(@preview_form) do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>              on(:ok) do</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>                return redirect_to form_params[:preview_url] if params[:show_preview].present? || params[:is_from_participatory_text_preview].present?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>                set_flash_and_redirect(&quot;participatory_texts.update.success&quot;, EngineRouter.admin_proxy(current_component).participatory_texts_path)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>              end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>              on(:invalid) do |failures|</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>Decidim::Proposals::Admin::ProposalsController</td>
      <td>update</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
      <td>[601]</td>
      <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" >Possible unprotected redirect near line 162: <span class="code">redirect_to(<span class="user_input">params.require(:proposal).permit![:preview_url]</span>)</span><table id='context9' class='context' style='display:none'><caption>app/controllers/decidim/proposals/admin/proposals_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>157</pre>
          </td>
          <td class='context'>
            <pre class='context'>          form_params = params.require(:proposal).permit!</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>159</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Admin::UpdateProposal.call(@form, @proposal) do</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>160</pre>
            </td>
            <td class='context'>
              <pre class='context'>            on(:ok) do |_proposal|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>161</pre>
            </td>
            <td class='context'>
              <pre class='context'>              flash[:notice] = t(&quot;proposals.update.success&quot;, scope: &quot;decidim&quot;)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>162</pre>
            </td>
            <td class='context'>
              <pre class='context'>              return redirect_to form_params[:preview_url] if form_params[:is_from_participatory_text_preview].present?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>              redirect_to proposals_path</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>            end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>            on(:invalid) do</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>Decidim::ParticipatoryProcesses::ParticipatoryProcessesController</td>
      <td>all_items_of_a_participatory_process</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td>[470]</td>
      <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" >Unsafe reflection method <span class="code">constantize</span> called on parameter value near line 82: <span class="code">&quot;Decidim::#{<span class="user_input">params[:component].to_s.capitalize</span>}::#{<span class="user_input">params[:component].to_s.capitalize</span>.singularize}&quot;.constantize</span><table id='context14' class='context' style='display:none'><caption>app/controllers/decidim/participatory_processes/participatory_processes_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>77</pre>
          </td>
          <td class='context'>
            <pre class='context'>        search = params[:search]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>        component_id = params[:component_id]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>        resource_type = params[:component]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        manifest_name = resource_type.to_s</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>        resource_class = &quot;Decidim::#{resource_type.to_s.capitalize}::#{resource_type.to_s.capitalize.singularize}&quot;.constantize</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        component = Decidim::Component.find_by(</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>          manifest_name: manifest_name,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>          participatory_space_id: current_participatory_space.id,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>          participatory_space_type: &quot;Decidim::ParticipatoryProcess&quot;,</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td></td>
      <td></td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/unmaintained_dependency/">Unmaintained Dependency</a></td>
      <td>[1104]</td>
      <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" >Support for Rails 6.1.7.2 ended on 2024-10-01 near line 769<table id='context1' class='context' style='display:none'><caption>Gemfile.lock</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>764</pre>
          </td>
          <td class='context'>
            <pre class='context'>      rack</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>765</pre>
            </td>
            <td class='context'>
              <pre class='context'>    rack-proxy (0.7.6)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>766</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rack</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>767</pre>
            </td>
            <td class='context'>
              <pre class='context'>    rack-test (2.0.2)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>768</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rack (&gt;= 1.3)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>769</pre>
            </td>
            <td class='context'>
              <pre class='context'>    rails (6.1.7.2)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>770</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actioncable (= 6.1.7.2)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>771</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actionmailbox (= 6.1.7.2)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>772</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actionmailer (= 6.1.7.2)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>773</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actionpack (= 6.1.7.2)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>774</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actiontext (= 6.1.7.2)</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td></td>
      <td></td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/unmaintained_dependency/">Unmaintained Dependency</a></td>
      <td>[1104]</td>
      <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" >Support for Ruby 3.0.4 ended on 2024-03-31 near line 1<table id='context2' class='context' style='display:none'><caption>.ruby-version</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>3.0.4</pre>
          </td>
        </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Admin::ComponentsController</td>
      <td>component_params</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
      <td>[915]</td>
      <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 131: <span class="code">params[:component].permit!</span><table id='context3' class='context' style='display:none'><caption>app/controllers/decidim/admin/components_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>126</pre>
          </td>
          <td class='context'>
            <pre class='context'>      # Processes the component params so the form object defined in the manifest (component_form_class_name)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # can assign and validate the attributes when using #from_params.</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>      def component_params</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>        new_settings = proc { |name, data| Component.build_settings(manifest, name, data, current_organization) }</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>        params[:component].permit!.tap do |hsh|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>          hsh[:id] = params[:id]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>          hsh[:manifest] = manifest</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>          hsh[:participatory_space] = current_participatory_space</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>          hsh[:settings] = new_settings.call(:global, hsh[:settings])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>          if hsh[:default_step_settings]</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Proposals::Admin::ParticipatoryTextsController</td>
      <td>update</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
      <td>[915]</td>
      <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 62: <span class="code">params.require(:preview_participatory_text).permit!</span><table id='context4' class='context' style='display:none'><caption>app/controllers/decidim/proposals/admin/participatory_texts_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>        # When `save_draft` param exists, proposals are only saved.</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # When no `save_draft` param is set, proposals are saved and published.</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        def update</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          enforce_permission_to :manage, :participatory_texts</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>          form_params = params.require(:preview_participatory_text).permit!</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @preview_form = form(Admin::PreviewParticipatoryTextForm).from_params(proposals: form_params[:proposals_attributes]&amp;.values, proposal_to_add: form_params[:proposal_to_add])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>          if params[:save_draft].present? || params[:show_preview].present? || params[:is_from_participatory_text_preview].present?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>            UpdateParticipatoryText.call(@preview_form) do</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>              on(:ok) do</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Proposals::Admin::ParticipatoryTextsController</td>
      <td>update_as_preview</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
      <td>[915]</td>
      <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 92: <span class="code">params.require(:preview_participatory_text).permit!</span><table id='context5' class='context' style='display:none'><caption>app/controllers/decidim/proposals/admin/participatory_texts_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>87</pre>
          </td>
          <td class='context'>
            <pre class='context'>          end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>        def update_as_preview</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>          enforce_permission_to :manage, :participatory_texts</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>          form_params = params.require(:preview_participatory_text).permit!</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @preview_form = form(Admin::PreviewParticipatoryTextForm).from_params(proposals: form_params[:proposals_attributes]&amp;.values, proposal_to_add: form_params[:proposal_to_add])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>          PublishParticipatoryText.call(@preview_form) do</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>            on(:ok) do</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Proposals::Admin::ProposalsController</td>
      <td>update</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
      <td>[915]</td>
      <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 157: <span class="code">params.require(:proposal).permit!</span><table id='context6' class='context' style='display:none'><caption>app/controllers/decidim/proposals/admin/proposals_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>152</pre>
          </td>
          <td class='context'>
            <pre class='context'>                              .find(params[:id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>          enforce_permission_to :edit, :proposal, proposal: @proposal</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @form = form(Admin::ProposalForm).from_params(params)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>          form_params = params.require(:proposal).permit!</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>159</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Admin::UpdateProposal.call(@form, @proposal) do</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>160</pre>
            </td>
            <td class='context'>
              <pre class='context'>            on(:ok) do |_proposal|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>161</pre>
            </td>
            <td class='context'>
              <pre class='context'>              flash[:notice] = t(&quot;proposals.update.success&quot;, scope: &quot;decidim&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>162</pre>
            </td>
            <td class='context'>
              <pre class='context'>              return redirect_to form_params[:preview_url] if form_params[:is_from_participatory_text_preview].present?</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Govbr::UserProposalsStatisticSetting</td>
      <td>get_user_proposals_data</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
      <td>[89]</td>
      <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" >Possible SQL injection near line 92: <span class="code">ActiveRecord::Base.connection.execute(&quot;SELECT du.id as decidim_user_id, du.name as decidim_user_name, COUNT(dpp.id) as proposals_done, SUM(dpp.proposal_votes_count) as votes_received, SUM(dpp.comments_count) as comments_received, SUM(dpp.follows_count) as follows_received\n  FROM decidim_components as dc\n  INNER JOIN decidim_proposals_proposals as dpp\n    ON dc.id = dpp.decidim_component_id\n  INNER JOIN decidim_coauthorships as coauth\n    ON coauth.coauthorable_type = &#39;Decidim::Proposals::Proposal&#39; AND coauth.coauthorable_id = dpp.id\n  INNER JOIN decidim_users as du\n    ON du.id = coauth.decidim_author_id\n  WHERE dc.participatory_space_type = &#39;#{<span class="user_input">decidim_participatory_space_type</span>}&#39;\n    AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;\nGROUP BY du.id\n&quot;.squish)</span><table id='context10' class='context' style='display:none'><caption>app/models/decidim/govbr/user_proposals_statistic_setting.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>87</pre>
          </td>
          <td class='context'>
            <pre class='context'>              ON dc.id = dpp.decidim_component_id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>            INNER JOIN decidim_coauthorships as coauth</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON coauth.coauthorable_type = &#39;Decidim::Proposals::Proposal&#39; AND coauth.coauthorable_id = dpp.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>            INNER JOIN decidim_users as du</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON du.id = coauth.decidim_author_id</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>            WHERE dc.participatory_space_type = &#39;#{decidim_participatory_space_type}&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>              AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>          GROUP BY du.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>          SQL</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>        )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Govbr::UserProposalsStatisticSetting</td>
      <td>get_user_comments_data</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
      <td>[89]</td>
      <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" >Possible SQL injection near line 111: <span class="code">ActiveRecord::Base.connection.execute(&quot;SELECT du.id as decidim_user_id, du.name as decidim_user_name, COUNT(dcc.id) as comments_done\n  FROM decidim_components as dc\n  INNER JOIN decidim_proposals_proposals as dpp\n    ON dc.id = dpp.decidim_component_id\n  INNER JOIN decidim_comments_comments as dcc\n    ON dcc.decidim_commentable_id = dpp.id\n  INNER JOIN decidim_users as du\n    ON du.id = dcc.decidim_author_id\n  WHERE dcc.decidim_commentable_type = &#39;Decidim::Proposals::Proposal&#39;\n    AND dc.participatory_space_type = &#39;#{<span class="user_input">decidim_participatory_space_type</span>}&#39;\n    AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;\nGROUP BY du.id\n&quot;.squish)</span><table id='context11' class='context' style='display:none'><caption>app/models/decidim/govbr/user_proposals_statistic_setting.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>106</pre>
          </td>
          <td class='context'>
            <pre class='context'>            INNER JOIN decidim_comments_comments as dcc</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON dcc.decidim_commentable_id = dpp.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>            INNER JOIN decidim_users as du</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON du.id = dcc.decidim_author_id</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>            WHERE dcc.decidim_commentable_type = &#39;Decidim::Proposals::Proposal&#39;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>              AND dc.participatory_space_type = &#39;#{decidim_participatory_space_type}&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>              AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>          GROUP BY du.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>          SQL</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>        )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Govbr::UserProposalsStatisticSetting</td>
      <td>get_user_votes_data</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
      <td>[89]</td>
      <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" >Possible SQL injection near line 129: <span class="code">ActiveRecord::Base.connection.execute(&quot;SELECT du.id as decidim_user_id, du.name as decidim_user_name, COUNT(dppv.id) as votes_done\n  FROM decidim_components as dc\n  INNER JOIN decidim_proposals_proposals as dpp\n    ON dc.id = dpp.decidim_component_id\n  INNER JOIN decidim_proposals_proposal_votes as dppv\n    ON dppv.decidim_proposal_id = dpp.id\n  INNER JOIN decidim_users as du\n    ON du.id = dppv.decidim_author_id\n  WHERE dc.participatory_space_type = &#39;#{<span class="user_input">decidim_participatory_space_type</span>}&#39;\n    AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;\nGROUP BY du.id\n&quot;.squish)</span><table id='context12' class='context' style='display:none'><caption>app/models/decidim/govbr/user_proposals_statistic_setting.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>124</pre>
          </td>
          <td class='context'>
            <pre class='context'>              ON dc.id = dpp.decidim_component_id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>            INNER JOIN decidim_proposals_proposal_votes as dppv</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON dppv.decidim_proposal_id = dpp.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>            INNER JOIN decidim_users as du</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON du.id = dppv.decidim_author_id</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>            WHERE dc.participatory_space_type = &#39;#{decidim_participatory_space_type}&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>              AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>          GROUP BY du.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>          SQL</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>        )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Decidim::Govbr::UserProposalsStatisticSetting</td>
      <td>get_user_follows_data</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
      <td>[89]</td>
      <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" >Possible SQL injection near line 148: <span class="code">ActiveRecord::Base.connection.execute(&quot;SELECT du.id as decidim_user_id, du.name as decidim_user_name, COUNT(df.id) as follows_done\n  FROM decidim_components as dc\n  INNER JOIN decidim_proposals_proposals as dpp\n    ON dc.id = dpp.decidim_component_id\n  INNER JOIN decidim_follows as df\n    ON df.decidim_followable_id = dpp.id\n  INNER JOIN decidim_users as du\n    ON du.id = df.decidim_user_id\n  WHERE df.decidim_followable_type = &#39;Decidim::Proposals::Proposal&#39;\n    AND dc.participatory_space_type = &#39;#{<span class="user_input">decidim_participatory_space_type</span>}&#39;\n    AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;\nGROUP BY du.id\n&quot;.squish)</span><table id='context13' class='context' style='display:none'><caption>app/models/decidim/govbr/user_proposals_statistic_setting.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>143</pre>
          </td>
          <td class='context'>
            <pre class='context'>            INNER JOIN decidim_follows as df</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON df.decidim_followable_id = dpp.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>            INNER JOIN decidim_users as du</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>              ON du.id = df.decidim_user_id</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>147</pre>
            </td>
            <td class='context'>
              <pre class='context'>            WHERE df.decidim_followable_type = &#39;Decidim::Proposals::Proposal&#39;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>              AND dc.participatory_space_type = &#39;#{decidim_participatory_space_type}&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>              AND dc.participatory_space_id = &#39;#{decidim_participatory_space_id}&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>          GROUP BY du.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>151</pre>
            </td>
            <td class='context'>
              <pre class='context'>          SQL</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>        )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>Decidim::Assemblies::AssembliesController</td>
      <td>search</td>
      <td><a rel="noreferrer" href="https://positive.security/blog/ransack-data-exfiltration">Missing Authorization</a></td>
      <td>[862]</td>
      <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" >Unrestricted search using <span class="code">ransack</span> library called with parameter value. Limit search by defining <span class="code">ransackable_attributes</span> and <span class="code">ransackable_associations</span> methods in class or upgrade Ransack to version 4.0.0 or newer near line 61: <span class="code">search_collection.ransack((<span class="user_input">params[:q]</span> or default_filter_params))</span><table id='context7' class='context' style='display:none'><caption>app/controllers/decidim/assemblies/assemblies_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>56</pre>
          </td>
          <td class='context'>
            <pre class='context'>      def search_collection</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>        Assembly.where(organization: current_organization).published.visible_for(current_user)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      def search</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @search ||= search_collection.ransack(params[:q] || default_filter_params)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      def default_filter_params</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        filtered_params = {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>          with_any_scope: nil,</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table>
<p>Model Warnings</p>
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Model</th>
      <th>Warning Type</th>
      <th>CWE ID</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>Decidim::StaticPage</td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/format_validation/">Format Validation</a></td>
      <td>[777]</td>
      <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" >Insufficient validation for <span class="code">slug</span> using <span class="code">/\A[a-z0-9-]+/</span>. Use <span class="code">\A</span> and <span class="code">\z</span> as anchors near line 21<table id='context15' class='context' style='display:none'><caption>app/models/decidim/static_page.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>17</pre>
          </td>
          <td class='context'>
            <pre class='context'>    belongs_to :organization, foreign_key: &quot;decidim_organization_id&quot;, class_name: &quot;Decidim::Organization&quot;, inverse_of: :static_pages</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>    belongs_to :topic, class_name: &quot;Decidim::StaticPageTopic&quot;, optional: true</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>    validates :slug, presence: true, uniqueness: { scope: :organization }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    validates :slug, format: { with: /\A[a-z0-9-]+/ }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # These pages will be created by default when registering an organization</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # and cannot be deleted.</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    DEFAULT_PAGES = %w(terms-and-conditions).freeze</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table><p>View Warnings</p>
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Template</th>
      <th>Warning Type</th>
      <th>CWE ID</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          decidim/proposals/proposals/preview (Decidim::Proposals::ProposalsController#preview)
        
      </td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td>[79]</td>
      <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" >Unescaped parameter value near line 31: <span class="code">cell(&quot;decidim/proposals/proposal_m&quot;, Proposal.find(<span class="user_input">params[:id]</span>), :full_badge =&gt; true).badge</span><table id='context16' class='context' style='display:none'><caption>app/views/decidim/proposals/proposals/preview.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>26</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;div class=&quot;content-container&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;div class=&quot;main-content&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;p class=&quot;pre-view-help-text&quot;&gt;&lt;%= t(&quot;.help_preview&quot;) %&gt;&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;!-- Tag de status da proposta. Ex: Retirada, Incorporada --&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% if not @proposal.emendation? and not [&quot;section&quot;,&quot;subsection&quot;].include? @proposal.participatory_text_level %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%== cell(&quot;decidim/proposals/proposal_m&quot;, @proposal, full_badge: true).badge %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;!-- Titulo da proposta --&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% if @proposal.emendation? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;h2 class=&quot;proposal-title&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;%= t(&quot;.changes_at_title&quot;, title: present(@proposal.amendable).title(links: true, html_escape: true)) %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          decidim/proposals/proposals/show (Decidim::Proposals::ProposalsController#show)
        
      </td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td>[79]</td>
      <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" >Unescaped parameter value near line 42: <span class="code">cell(&quot;decidim/proposals/proposal_m&quot;, Proposal.find(<span class="user_input">params[:id]</span>), :full_badge =&gt; true).badge</span><table id='context17' class='context' style='display:none'><caption>app/views/decidim/proposals/proposals/show.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;span class=&quot;br-divider my-5&quot;&gt;&lt;/span&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;div class=&quot;content-container&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;div class=&quot;main-content&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;!-- Tag de status da proposta. Ex: Retirada, Incorporada --&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% if not @proposal.emendation? and not [&quot;section&quot;,&quot;subsection&quot;].include? @proposal.participatory_text_level %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%== cell(&quot;decidim/proposals/proposal_m&quot;, @proposal, full_badge: true).badge %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;!-- Titulo da proposta --&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% if @proposal.emendation? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;h2 class=&quot;proposal-title&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;%= t(&quot;.changes_at_title&quot;, title: present(@proposal.amendable).title(links: true, html_escape: true)) %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          decidim/proposals/proposals/show (Decidim::Proposals::ProposalsController#show)
        
      </td>
      <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td>[79]</td>
      <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" >Unescaped parameter value near line 61: <span class="code">translated_attribute(Proposal.find(<span class="user_input">params[:id]</span>).body)</span><table id='context18' class='context' style='display:none'><caption>app/views/decidim/proposals/proposals/show.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>      &lt;% # Body render %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% if not @proposal.emendation? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%= content_tag :div, class: &#39;br-proposal_body&#39; do  %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% if !text_before_v2_release?(@proposal) &amp;&amp; @proposal.participatory_text_level.present? %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%== translated_attribute(@proposal.body) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% render_proposal_body(@proposal)%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% end%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% end %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table>
</body></html>